<template></template>
<script>
export default {
  name: "HighlightText",
  props: {
    searchTerm: {
      type: String,
      required: false,
      default: null
    },
    text: {
      type: String,
      required: false,
      default: null
    }
  },

  render(createElement) {
    return createElement("div", {
      class: "sw-highlight-text",
      domProps: { innerHTML: this.searchAndReplace() }
    });
  },

  methods: {
    searchAndReplace() {
      if (!this.text) {
        return "";
      }

      if (!this.searchTerm) {
        return this.text;
      }

      const prefix = '<span class="sw-highlight-text__highlight">';
      const suffix = "</span>";

      const regExp = new RegExp(this.escapeRegExp(this.searchTerm), "ig");
      return this.text.replace(regExp, str => `${prefix}${str}${suffix}`);
    },

    // Remove regex special characters from search string
    escapeRegExp(string) {
      return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"); // $& means the whole matched string
    }
  }
};
</script>
<style lang="scss">
@import "../scss/variables";

.sw-highlight-text {
  .sw-highlight-text__highlight {
    color: blue;
    font-weight: bold;
  }
}
</style>